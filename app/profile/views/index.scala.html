@(user: User, edit: Boolean = false, messages: java.util.List[Html], subTitle: String = null, imageFile: String = null)

@layoutWithHead("Hybrida - " + user.getName()) {
    <div class="page">
        @if(edit) {
            <form method="POST" action="@profile.routes.Profile.update(user.getUsername())" onsubmit="$('#profile_image_file').prop('disabled', true)">
            }
        <h5 class="smallTitle">@user.getName()@if(subTitle != null && !subTitle.equals("")) { - @subTitle}</h5>
        <div class="buttons">
        @if(edit) {
            <input class="float-right btn btn-primary" type="submit" value="Lagre">
            <a class="float-right btn btn-primary" href="@profile.routes.Profile.index(user.getUsername())">Avbryt</a>
        } else {
            <a class="float-right btn btn-primary" href="@profile.routes.Profile.edit(user.getUsername())">Rediger</a>
        }
        </div>
        <div class="pageInner @if(edit){edit}else{nedit}">
            @if(imageFile != null && !imageFile.equals("")) {
                <div class="pageItem picFrame">@if(edit){<span>Last opp nytt bilde</span>}<img class="pic" src="@routes.Assets.at(imageFile)"></div>
            }else{ @if(edit){
                <div class="pageItem picFrame"><span>Last opp bilde</span><img class="pic" src="@routes.Assets.at("images/placeholder-profile.jpg")"></div>
            }}
            <h1 class="pageItem bigTitle">@user.getName()</h1>
            @if(subTitle != null && !subTitle.equals("")) {
                <h3 class="pageItem bigSubTitle">@subTitle</h3>
            }

            @if(!messages.isEmpty()) {
                <div class="messages">@(for(message <- messages) message)</div>
            }
            <div class="pageItem">
                <div class="info-block">
                    <ul>
                        <li>
                            <div class="label">NTNU-E-POST</div>
                            <div class="info">@(user.getUsername()) @@stud.ntnu.no</div>
                            <div class="clearfix"></div>
                        </li>
                        @if(edit || user.hasEmail()) {
                            <li>
                                <div class="label">ALTERNATIV E-POST</div>
                                <div class="info">
                                @if(edit) {
                                    <input type="email" name="email" value="@user.getEmail()">
                                    } else {
                                    @user.getEmail()
                                }
                                </div>
                                <div class="clearfix"></div>
                            </li>
                        }
                        @if(edit || user.hasWebsiteUrl()) {
                            <li>
                                <div class="label">HJEMMESIDE</div>
                                <div class="info">
                                @if(edit) {
                                    <input type="text" name="websiteUrl" value="@user.getWebsiteUrl()">
                                    } else {
                                    @user.getWebsiteUrl()
                                }
                                </div>
                                <div class="clearfix"></div>
                            </li>
                        }
                        @if(edit || user.hasPhone()) {
                            <li>
                                <div class="label">TELEFON</div>
                                <div class="info">
                                @if(edit) {
                                    <input type="text" name="phone" value="@user.getPhone()">
                                    } else {
                                    @user.getPhone()
                                }
                                </div>
                                <div class="clearfix"></div>
                            </li>
                        }
                    </ul>
                </div>
                <div class="info-block">
                    <ul>
                        @if(edit || "mf".contains(user.getGender())) {
                            <li>
                                <div class="label">KJÃ˜NN</div>
                                <div class="info">
                                @if(edit) {
                                    <input type="radio" name="gender" value="m" @(if(user.getGender() == 'm') "CHECKED")> <label for="gender">Mann</label> |
                                    <input type="radio" name="gender" value="f" @(if(user.getGender() == 'f') "CHECKED")> <label for="gender">Kvinne</label>
                                } else {
                                    @(if(user.getGender() == 'm') "Mann" else "Kvinne")
                                }
                                </div>
                                <div class="clearfix"></div>
                            </li>
                        }
                        @if(edit) {
                            <li class="hidden">
                                <div class="label">PROFILBILDE</div>
                                <div class="info upload-input">
                                    <input type="file" name="profileImageFile" id="profileImageFile">
                                    <span class="glyphicon glyphicon-folder-open indicator" style="float:right"></span>
                                    <input type="hidden" name="profileImageFileName" id="profileImageFileName" value="@user.getProfileImageFileName()">
                                    <input type="button" onclick="uploadImage($('#profile_image_file')[0])" value="Last opp">
                                    <script type="text/javascript">
                                        function uploadImage(filesParent){
                                            $(".indicator").attr("class", "glyphicon glyphicon-option-horizontal indicator");
                                            uploadFile(filesParent.files[0], function(url) {
                                                var filename = url.substring(url.lastIndexOf("/")+1);
                                                $("#profileImageFileName").val(filename);
                                                $(".pic").attr("src", url);
                                                $(".picFrame").removeClass("hidden");
                                                $(".indicator").attr("class", "glyphicon glyphicon-ok-sign indicator");
                                            }, "@user.getUsername");
                                        }

                                        $(".edit .picFrame").click(function(){$("#profileImageFile").click()})
                                            .on("dragover", function(jqe) {
                                                var e = jqe.originalEvent;
                                                e.stopPropagation();
                                                e.preventDefault();
                                                e.dataTransfer.dropEffect = 'copy';
                                            })
                                            .on("drop", function(jqe) {
                                                var e = jqe.originalEvent;
                                                e.stopPropagation();
                                                e.preventDefault();
                                                uploadImage(e.dataTransfer);
                                            });
                                        $("#profileImageFile").change(function(){uploadImage(this);})
                                    </script>
                                </div>
                                <div class="clearfix"></div>
                            </li>
                        }
                    </ul>
                </div>
            </div>

            <div class="clearfix">
            </div>
        </div>
        @if(edit) {
        </form>
        }
    </div>
} {
    <link rel="stylesheet" type="text/css" href="@routes.Assets.at("stylesheets/profile.css")" />
}